"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),n=e(t),r=e(require("prop-types")),i=e(require("invariant")),a=e(require("json2mq"));function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var o=function(){function e(e,t,n){var r=this;this.nativeMediaQueryList=e.matchMedia(t),this.active=!0,this.cancellableListener=function(){r.matches=r.nativeMediaQueryList.matches,r.active&&n.apply(void 0,arguments)},this.nativeMediaQueryList.addListener(this.cancellableListener),this.matches=this.nativeMediaQueryList.matches}return e.prototype.cancel=function(){this.active=!1,this.nativeMediaQueryList.removeListener(this.cancellableListener)},e}(),c=function(e){var n=e.query,r=e.queries,c=e.defaultMatches,s=e.targetWindow,f=e.onChange;!function(e){var t=e.query,n=e.queries,r=e.defaultMatches;t||n||t&&n||i(!1),void 0!==r&&t&&"boolean"!=typeof r&&i(!1),void 0!==r&&n&&"object"!=typeof r&&i(!1)}({query:n,queries:r,defaultMatches:c});var l=t.useRef([]),d=function(){var e,t,n=l.current.reduce((function(e,t){var n,r=t.name,i=t.mqListener;return u({},e,((n={})[r]=i.matches,n))}),{});return e=n,1===(t=Object.keys(e)).length&&"__DEFAULT__"===t[0]?e.__DEFAULT__:e},y=function(){v(d())},h=t.useState((function(){return"object"!=typeof window?void 0!==c?c:!!n||Object.keys(r).reduce((function(e,t){var n;return u({},e,((n={})[t]=!0,n))}),{}):(function(){var e=s||window;"function"!=typeof e.matchMedia&&i(!1);var t=r||function(e){return{__DEFAULT__:e}}(n);l.current=Object.keys(t).map((function(n){var r=t[n],i="string"!=typeof r?a(r):r;return{name:n,mqListener:new o(e,i,y)}}))}(),d())})),p=h[0],v=h[1];return t.useEffect((function(){return function(){return l.current.forEach((function(e){return e.mqListener.cancel()}))}}),[]),t.useEffect((function(){f&&f(p)}),[p,f]),p},s=function(e){var t=e.defaultMatches,r=e.query,i=e.queries,a=e.render,u=e.children,o=e.targetWindow,s=e.onChange,f=c({query:r,queries:i,defaultMatches:t,targetWindow:o,onChange:s}),l="object"==typeof f?Object.keys(f).some((function(e){return f[e]})):f;return a?l?a(f):null:u?"function"==typeof u?u(f):(!Array.isArray(u)||u.length)&&l?n.Children.only(u)&&"string"==typeof n.Children.only(u).type?n.Children.only(u):n.cloneElement(n.Children.only(u),{matches:f}):null:null},f=r.oneOfType([r.string,r.object,r.arrayOf(r.object.isRequired)]);s.propTypes={defaultMatches:r.oneOfType([r.bool,r.objectOf(r.bool)]),query:f,queries:r.objectOf(f),render:r.func,children:r.oneOfType([r.node,r.func]),targetWindow:r.object,onChange:r.func},exports.default=s,exports.useMedia=c;
